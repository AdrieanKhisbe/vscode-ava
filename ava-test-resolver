#!/usr/bin/env node
const mock = require('mock-require')
const stackTrace = require('stack-trace');

const testList = []

const collectTestMock = type => function (testTitle, implementation) {
	const st = stackTrace.get();
	const title = typeof testTitle === 'string' ? testTitle : '<anonymous test>'
	testList.push([title, st[1].getLineNumber(), type])
}
const avaMock = {
	test: collectTestMock('standard')
};
avaMock.test.cb = collectTestMock('standard');
avaMock.test.serial = collectTestMock('standard');
avaMock.test.only = collectTestMock('standard');
avaMock.test.skip = collectTestMock('skip');
avaMock.test.todo = collectTestMock('todo');
avaMock.test.failing = collectTestMock('failing');
// Â§TODO beforeAndAfter
mock('ava',avaMock);

require(process.argv[2]);
mock.stop('ava')
console.log(JSON.stringify(testList));
